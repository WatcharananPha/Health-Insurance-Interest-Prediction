{"cells":[{"source":"<a href=\"https://www.kaggle.com/code/logispactive/health-insurance-interest-prediction?scriptVersionId=131433392\" target=\"_blank\"><img align=\"left\" alt=\"Kaggle\" title=\"Open in Kaggle\" src=\"https://kaggle.com/static/images/open-in-kaggle.svg\"></a>","metadata":{},"cell_type":"markdown"},{"cell_type":"code","execution_count":1,"metadata":{"execution":{"iopub.execute_input":"2023-05-29T10:12:58.117556Z","iopub.status.busy":"2023-05-29T10:12:58.116219Z","iopub.status.idle":"2023-05-29T10:12:58.120795Z","shell.execute_reply":"2023-05-29T10:12:58.121591Z"},"papermill":{"duration":0.056589,"end_time":"2023-05-29T10:12:58.121833","exception":false,"start_time":"2023-05-29T10:12:58.065244","status":"completed"},"tags":[]},"outputs":[],"source":["# Health Insurance Interest Prediction Getting Started"]},{"cell_type":"code","execution_count":2,"metadata":{"_cell_guid":"b1076dfc-b9ad-4769-8c92-a6c4dae69d19","_uuid":"8f2839f25d086af736a60e9eeb907d3b93b6e0e5","execution":{"iopub.execute_input":"2023-05-29T10:12:58.221503Z","iopub.status.busy":"2023-05-29T10:12:58.220657Z","iopub.status.idle":"2023-05-29T10:13:07.732395Z","shell.execute_reply":"2023-05-29T10:13:07.730791Z","shell.execute_reply.started":"2023-03-23T09:21:12.45441Z"},"papermill":{"duration":9.562042,"end_time":"2023-05-29T10:13:07.732579","exception":false,"start_time":"2023-05-29T10:12:58.170537","status":"completed"},"tags":[]},"outputs":[],"source":["import numpy as np\n","import pandas as pd\n","import plotly.express as px\n","\n","from sklearn.preprocessing import LabelEncoder\n","from sklearn.preprocessing import MinMaxScaler\n","from sklearn.model_selection import train_test_split\n","\n","import tensorflow as tf"]},{"cell_type":"code","execution_count":3,"metadata":{"execution":{"iopub.execute_input":"2023-05-29T10:13:07.823801Z","iopub.status.busy":"2023-05-29T10:13:07.822858Z","iopub.status.idle":"2023-05-29T10:13:09.077214Z","shell.execute_reply":"2023-05-29T10:13:09.076364Z","shell.execute_reply.started":"2023-03-23T09:21:12.46171Z"},"papermill":{"duration":1.301408,"end_time":"2023-05-29T10:13:09.077403","exception":false,"start_time":"2023-05-29T10:13:07.775995","status":"completed"},"tags":[]},"outputs":[],"source":["train_df = pd.read_csv('../input/health-insurance-cross-sell-prediction/train.csv')\n","test_df = pd.read_csv('../input/health-insurance-cross-sell-prediction/test.csv')\n","sample_submission = pd.read_csv('../input/health-insurance-cross-sell-prediction/sample_submission.csv')"]},{"cell_type":"code","execution_count":4,"metadata":{"execution":{"iopub.execute_input":"2023-05-29T10:13:09.177801Z","iopub.status.busy":"2023-05-29T10:13:09.176308Z","iopub.status.idle":"2023-05-29T10:13:09.216929Z","shell.execute_reply":"2023-05-29T10:13:09.217593Z","shell.execute_reply.started":"2023-03-23T09:21:13.414282Z"},"papermill":{"duration":0.096367,"end_time":"2023-05-29T10:13:09.217789","exception":false,"start_time":"2023-05-29T10:13:09.121422","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>id</th>\n","      <th>Gender</th>\n","      <th>Age</th>\n","      <th>Driving_License</th>\n","      <th>Region_Code</th>\n","      <th>Previously_Insured</th>\n","      <th>Vehicle_Age</th>\n","      <th>Vehicle_Damage</th>\n","      <th>Annual_Premium</th>\n","      <th>Policy_Sales_Channel</th>\n","      <th>Vintage</th>\n","      <th>Response</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1</td>\n","      <td>Male</td>\n","      <td>44</td>\n","      <td>1</td>\n","      <td>28.0</td>\n","      <td>0</td>\n","      <td>&gt; 2 Years</td>\n","      <td>Yes</td>\n","      <td>40454.0</td>\n","      <td>26.0</td>\n","      <td>217</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2</td>\n","      <td>Male</td>\n","      <td>76</td>\n","      <td>1</td>\n","      <td>3.0</td>\n","      <td>0</td>\n","      <td>1-2 Year</td>\n","      <td>No</td>\n","      <td>33536.0</td>\n","      <td>26.0</td>\n","      <td>183</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>3</td>\n","      <td>Male</td>\n","      <td>47</td>\n","      <td>1</td>\n","      <td>28.0</td>\n","      <td>0</td>\n","      <td>&gt; 2 Years</td>\n","      <td>Yes</td>\n","      <td>38294.0</td>\n","      <td>26.0</td>\n","      <td>27</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>4</td>\n","      <td>Male</td>\n","      <td>21</td>\n","      <td>1</td>\n","      <td>11.0</td>\n","      <td>1</td>\n","      <td>&lt; 1 Year</td>\n","      <td>No</td>\n","      <td>28619.0</td>\n","      <td>152.0</td>\n","      <td>203</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>5</td>\n","      <td>Female</td>\n","      <td>29</td>\n","      <td>1</td>\n","      <td>41.0</td>\n","      <td>1</td>\n","      <td>&lt; 1 Year</td>\n","      <td>No</td>\n","      <td>27496.0</td>\n","      <td>152.0</td>\n","      <td>39</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>381104</th>\n","      <td>381105</td>\n","      <td>Male</td>\n","      <td>74</td>\n","      <td>1</td>\n","      <td>26.0</td>\n","      <td>1</td>\n","      <td>1-2 Year</td>\n","      <td>No</td>\n","      <td>30170.0</td>\n","      <td>26.0</td>\n","      <td>88</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>381105</th>\n","      <td>381106</td>\n","      <td>Male</td>\n","      <td>30</td>\n","      <td>1</td>\n","      <td>37.0</td>\n","      <td>1</td>\n","      <td>&lt; 1 Year</td>\n","      <td>No</td>\n","      <td>40016.0</td>\n","      <td>152.0</td>\n","      <td>131</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>381106</th>\n","      <td>381107</td>\n","      <td>Male</td>\n","      <td>21</td>\n","      <td>1</td>\n","      <td>30.0</td>\n","      <td>1</td>\n","      <td>&lt; 1 Year</td>\n","      <td>No</td>\n","      <td>35118.0</td>\n","      <td>160.0</td>\n","      <td>161</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>381107</th>\n","      <td>381108</td>\n","      <td>Female</td>\n","      <td>68</td>\n","      <td>1</td>\n","      <td>14.0</td>\n","      <td>0</td>\n","      <td>&gt; 2 Years</td>\n","      <td>Yes</td>\n","      <td>44617.0</td>\n","      <td>124.0</td>\n","      <td>74</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>381108</th>\n","      <td>381109</td>\n","      <td>Male</td>\n","      <td>46</td>\n","      <td>1</td>\n","      <td>29.0</td>\n","      <td>0</td>\n","      <td>1-2 Year</td>\n","      <td>No</td>\n","      <td>41777.0</td>\n","      <td>26.0</td>\n","      <td>237</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>381109 rows Ã— 12 columns</p>\n","</div>"],"text/plain":["            id  Gender  Age  Driving_License  Region_Code  Previously_Insured  \\\n","0            1    Male   44                1         28.0                   0   \n","1            2    Male   76                1          3.0                   0   \n","2            3    Male   47                1         28.0                   0   \n","3            4    Male   21                1         11.0                   1   \n","4            5  Female   29                1         41.0                   1   \n","...        ...     ...  ...              ...          ...                 ...   \n","381104  381105    Male   74                1         26.0                   1   \n","381105  381106    Male   30                1         37.0                   1   \n","381106  381107    Male   21                1         30.0                   1   \n","381107  381108  Female   68                1         14.0                   0   \n","381108  381109    Male   46                1         29.0                   0   \n","\n","       Vehicle_Age Vehicle_Damage  Annual_Premium  Policy_Sales_Channel  \\\n","0        > 2 Years            Yes         40454.0                  26.0   \n","1         1-2 Year             No         33536.0                  26.0   \n","2        > 2 Years            Yes         38294.0                  26.0   \n","3         < 1 Year             No         28619.0                 152.0   \n","4         < 1 Year             No         27496.0                 152.0   \n","...            ...            ...             ...                   ...   \n","381104    1-2 Year             No         30170.0                  26.0   \n","381105    < 1 Year             No         40016.0                 152.0   \n","381106    < 1 Year             No         35118.0                 160.0   \n","381107   > 2 Years            Yes         44617.0                 124.0   \n","381108    1-2 Year             No         41777.0                  26.0   \n","\n","        Vintage  Response  \n","0           217         1  \n","1           183         0  \n","2            27         1  \n","3           203         0  \n","4            39         0  \n","...         ...       ...  \n","381104       88         0  \n","381105      131         0  \n","381106      161         0  \n","381107       74         0  \n","381108      237         0  \n","\n","[381109 rows x 12 columns]"]},"execution_count":4,"metadata":{},"output_type":"execute_result"}],"source":["train_df"]},{"cell_type":"code","execution_count":5,"metadata":{"execution":{"iopub.execute_input":"2023-05-29T10:13:09.33783Z","iopub.status.busy":"2023-05-29T10:13:09.336066Z","iopub.status.idle":"2023-05-29T10:13:09.341687Z","shell.execute_reply":"2023-05-29T10:13:09.34234Z","shell.execute_reply.started":"2023-03-23T09:21:13.452676Z"},"papermill":{"duration":0.079191,"end_time":"2023-05-29T10:13:09.342532","exception":false,"start_time":"2023-05-29T10:13:09.263341","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>id</th>\n","      <th>Gender</th>\n","      <th>Age</th>\n","      <th>Driving_License</th>\n","      <th>Region_Code</th>\n","      <th>Previously_Insured</th>\n","      <th>Vehicle_Age</th>\n","      <th>Vehicle_Damage</th>\n","      <th>Annual_Premium</th>\n","      <th>Policy_Sales_Channel</th>\n","      <th>Vintage</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>381110</td>\n","      <td>Male</td>\n","      <td>25</td>\n","      <td>1</td>\n","      <td>11.0</td>\n","      <td>1</td>\n","      <td>&lt; 1 Year</td>\n","      <td>No</td>\n","      <td>35786.0</td>\n","      <td>152.0</td>\n","      <td>53</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>381111</td>\n","      <td>Male</td>\n","      <td>40</td>\n","      <td>1</td>\n","      <td>28.0</td>\n","      <td>0</td>\n","      <td>1-2 Year</td>\n","      <td>Yes</td>\n","      <td>33762.0</td>\n","      <td>7.0</td>\n","      <td>111</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>381112</td>\n","      <td>Male</td>\n","      <td>47</td>\n","      <td>1</td>\n","      <td>28.0</td>\n","      <td>0</td>\n","      <td>1-2 Year</td>\n","      <td>Yes</td>\n","      <td>40050.0</td>\n","      <td>124.0</td>\n","      <td>199</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>381113</td>\n","      <td>Male</td>\n","      <td>24</td>\n","      <td>1</td>\n","      <td>27.0</td>\n","      <td>1</td>\n","      <td>&lt; 1 Year</td>\n","      <td>Yes</td>\n","      <td>37356.0</td>\n","      <td>152.0</td>\n","      <td>187</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>381114</td>\n","      <td>Male</td>\n","      <td>27</td>\n","      <td>1</td>\n","      <td>28.0</td>\n","      <td>1</td>\n","      <td>&lt; 1 Year</td>\n","      <td>No</td>\n","      <td>59097.0</td>\n","      <td>152.0</td>\n","      <td>297</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>127032</th>\n","      <td>508142</td>\n","      <td>Female</td>\n","      <td>26</td>\n","      <td>1</td>\n","      <td>37.0</td>\n","      <td>1</td>\n","      <td>&lt; 1 Year</td>\n","      <td>No</td>\n","      <td>30867.0</td>\n","      <td>152.0</td>\n","      <td>56</td>\n","    </tr>\n","    <tr>\n","      <th>127033</th>\n","      <td>508143</td>\n","      <td>Female</td>\n","      <td>38</td>\n","      <td>1</td>\n","      <td>28.0</td>\n","      <td>0</td>\n","      <td>1-2 Year</td>\n","      <td>Yes</td>\n","      <td>28700.0</td>\n","      <td>122.0</td>\n","      <td>165</td>\n","    </tr>\n","    <tr>\n","      <th>127034</th>\n","      <td>508144</td>\n","      <td>Male</td>\n","      <td>21</td>\n","      <td>1</td>\n","      <td>46.0</td>\n","      <td>1</td>\n","      <td>&lt; 1 Year</td>\n","      <td>No</td>\n","      <td>29802.0</td>\n","      <td>152.0</td>\n","      <td>74</td>\n","    </tr>\n","    <tr>\n","      <th>127035</th>\n","      <td>508145</td>\n","      <td>Male</td>\n","      <td>71</td>\n","      <td>1</td>\n","      <td>28.0</td>\n","      <td>1</td>\n","      <td>1-2 Year</td>\n","      <td>No</td>\n","      <td>62875.0</td>\n","      <td>26.0</td>\n","      <td>265</td>\n","    </tr>\n","    <tr>\n","      <th>127036</th>\n","      <td>508146</td>\n","      <td>Male</td>\n","      <td>41</td>\n","      <td>1</td>\n","      <td>29.0</td>\n","      <td>1</td>\n","      <td>1-2 Year</td>\n","      <td>No</td>\n","      <td>27927.0</td>\n","      <td>124.0</td>\n","      <td>231</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>127037 rows Ã— 11 columns</p>\n","</div>"],"text/plain":["            id  Gender  Age  Driving_License  Region_Code  Previously_Insured  \\\n","0       381110    Male   25                1         11.0                   1   \n","1       381111    Male   40                1         28.0                   0   \n","2       381112    Male   47                1         28.0                   0   \n","3       381113    Male   24                1         27.0                   1   \n","4       381114    Male   27                1         28.0                   1   \n","...        ...     ...  ...              ...          ...                 ...   \n","127032  508142  Female   26                1         37.0                   1   \n","127033  508143  Female   38                1         28.0                   0   \n","127034  508144    Male   21                1         46.0                   1   \n","127035  508145    Male   71                1         28.0                   1   \n","127036  508146    Male   41                1         29.0                   1   \n","\n","       Vehicle_Age Vehicle_Damage  Annual_Premium  Policy_Sales_Channel  \\\n","0         < 1 Year             No         35786.0                 152.0   \n","1         1-2 Year            Yes         33762.0                   7.0   \n","2         1-2 Year            Yes         40050.0                 124.0   \n","3         < 1 Year            Yes         37356.0                 152.0   \n","4         < 1 Year             No         59097.0                 152.0   \n","...            ...            ...             ...                   ...   \n","127032    < 1 Year             No         30867.0                 152.0   \n","127033    1-2 Year            Yes         28700.0                 122.0   \n","127034    < 1 Year             No         29802.0                 152.0   \n","127035    1-2 Year             No         62875.0                  26.0   \n","127036    1-2 Year             No         27927.0                 124.0   \n","\n","        Vintage  \n","0            53  \n","1           111  \n","2           199  \n","3           187  \n","4           297  \n","...         ...  \n","127032       56  \n","127033      165  \n","127034       74  \n","127035      265  \n","127036      231  \n","\n","[127037 rows x 11 columns]"]},"execution_count":5,"metadata":{},"output_type":"execute_result"}],"source":["test_df"]},{"cell_type":"code","execution_count":6,"metadata":{"execution":{"iopub.execute_input":"2023-05-29T10:13:09.446321Z","iopub.status.busy":"2023-05-29T10:13:09.445073Z","iopub.status.idle":"2023-05-29T10:13:09.450611Z","shell.execute_reply":"2023-05-29T10:13:09.449625Z","shell.execute_reply.started":"2023-03-23T09:21:13.484675Z"},"papermill":{"duration":0.063693,"end_time":"2023-05-29T10:13:09.450779","exception":false,"start_time":"2023-05-29T10:13:09.387086","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>id</th>\n","      <th>Response</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>381110</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>381111</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>381112</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>381113</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>381114</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>127032</th>\n","      <td>508142</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>127033</th>\n","      <td>508143</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>127034</th>\n","      <td>508144</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>127035</th>\n","      <td>508145</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>127036</th>\n","      <td>508146</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>127037 rows Ã— 2 columns</p>\n","</div>"],"text/plain":["            id  Response\n","0       381110         0\n","1       381111         0\n","2       381112         0\n","3       381113         0\n","4       381114         0\n","...        ...       ...\n","127032  508142         0\n","127033  508143         0\n","127034  508144         0\n","127035  508145         0\n","127036  508146         0\n","\n","[127037 rows x 2 columns]"]},"execution_count":6,"metadata":{},"output_type":"execute_result"}],"source":["sample_submission"]},{"cell_type":"markdown","metadata":{"papermill":{"duration":0.046928,"end_time":"2023-05-29T10:13:09.546312","exception":false,"start_time":"2023-05-29T10:13:09.499384","status":"completed"},"tags":[]},"source":["# Preprocessing"]},{"cell_type":"code","execution_count":7,"metadata":{"execution":{"iopub.execute_input":"2023-05-29T10:13:09.645894Z","iopub.status.busy":"2023-05-29T10:13:09.645091Z","iopub.status.idle":"2023-05-29T10:13:09.798829Z","shell.execute_reply":"2023-05-29T10:13:09.798137Z","shell.execute_reply.started":"2023-03-23T09:21:13.498641Z"},"papermill":{"duration":0.203585,"end_time":"2023-05-29T10:13:09.799004","exception":false,"start_time":"2023-05-29T10:13:09.595419","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["<class 'pandas.core.frame.DataFrame'>\n","RangeIndex: 381109 entries, 0 to 381108\n","Data columns (total 12 columns):\n"," #   Column                Non-Null Count   Dtype  \n","---  ------                --------------   -----  \n"," 0   id                    381109 non-null  int64  \n"," 1   Gender                381109 non-null  object \n"," 2   Age                   381109 non-null  int64  \n"," 3   Driving_License       381109 non-null  int64  \n"," 4   Region_Code           381109 non-null  float64\n"," 5   Previously_Insured    381109 non-null  int64  \n"," 6   Vehicle_Age           381109 non-null  object \n"," 7   Vehicle_Damage        381109 non-null  object \n"," 8   Annual_Premium        381109 non-null  float64\n"," 9   Policy_Sales_Channel  381109 non-null  float64\n"," 10  Vintage               381109 non-null  int64  \n"," 11  Response              381109 non-null  int64  \n","dtypes: float64(3), int64(6), object(3)\n","memory usage: 34.9+ MB\n"]}],"source":["train_df.info()"]},{"cell_type":"markdown","metadata":{"papermill":{"duration":0.045364,"end_time":"2023-05-29T10:13:09.891391","exception":false,"start_time":"2023-05-29T10:13:09.846027","status":"completed"},"tags":[]},"source":["## Checking for Missing Values"]},{"cell_type":"code","execution_count":8,"metadata":{"execution":{"iopub.execute_input":"2023-05-29T10:13:09.98653Z","iopub.status.busy":"2023-05-29T10:13:09.985733Z","iopub.status.idle":"2023-05-29T10:13:10.12864Z","shell.execute_reply":"2023-05-29T10:13:10.129215Z","shell.execute_reply.started":"2023-03-23T09:21:13.577895Z"},"papermill":{"duration":0.193119,"end_time":"2023-05-29T10:13:10.129481","exception":false,"start_time":"2023-05-29T10:13:09.936362","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["id                      0\n","Gender                  0\n","Age                     0\n","Driving_License         0\n","Region_Code             0\n","Previously_Insured      0\n","Vehicle_Age             0\n","Vehicle_Damage          0\n","Annual_Premium          0\n","Policy_Sales_Channel    0\n","Vintage                 0\n","Response                0\n","dtype: int64"]},"execution_count":8,"metadata":{},"output_type":"execute_result"}],"source":["train_df.isna().sum()"]},{"cell_type":"code","execution_count":9,"metadata":{"execution":{"iopub.execute_input":"2023-05-29T10:13:10.227213Z","iopub.status.busy":"2023-05-29T10:13:10.226452Z","iopub.status.idle":"2023-05-29T10:13:10.281359Z","shell.execute_reply":"2023-05-29T10:13:10.280725Z","shell.execute_reply.started":"2023-03-23T09:21:13.648992Z"},"papermill":{"duration":0.105782,"end_time":"2023-05-29T10:13:10.281516","exception":false,"start_time":"2023-05-29T10:13:10.175734","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["id                      0\n","Gender                  0\n","Age                     0\n","Driving_License         0\n","Region_Code             0\n","Previously_Insured      0\n","Vehicle_Age             0\n","Vehicle_Damage          0\n","Annual_Premium          0\n","Policy_Sales_Channel    0\n","Vintage                 0\n","dtype: int64"]},"execution_count":9,"metadata":{},"output_type":"execute_result"}],"source":["test_df.isna().sum()"]},{"cell_type":"markdown","metadata":{"papermill":{"duration":0.046165,"end_time":"2023-05-29T10:13:10.376879","exception":false,"start_time":"2023-05-29T10:13:10.330714","status":"completed"},"tags":[]},"source":["## Encoding"]},{"cell_type":"code","execution_count":10,"metadata":{"execution":{"iopub.execute_input":"2023-05-29T10:13:10.482344Z","iopub.status.busy":"2023-05-29T10:13:10.481103Z","iopub.status.idle":"2023-05-29T10:13:10.508444Z","shell.execute_reply":"2023-05-29T10:13:10.509107Z","shell.execute_reply.started":"2023-03-23T09:21:13.680909Z"},"papermill":{"duration":0.083934,"end_time":"2023-05-29T10:13:10.509326","exception":false,"start_time":"2023-05-29T10:13:10.425392","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>id</th>\n","      <th>Gender</th>\n","      <th>Age</th>\n","      <th>Driving_License</th>\n","      <th>Region_Code</th>\n","      <th>Previously_Insured</th>\n","      <th>Vehicle_Age</th>\n","      <th>Vehicle_Damage</th>\n","      <th>Annual_Premium</th>\n","      <th>Policy_Sales_Channel</th>\n","      <th>Vintage</th>\n","      <th>Response</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1</td>\n","      <td>Male</td>\n","      <td>44</td>\n","      <td>1</td>\n","      <td>28.0</td>\n","      <td>0</td>\n","      <td>&gt; 2 Years</td>\n","      <td>Yes</td>\n","      <td>40454.0</td>\n","      <td>26.0</td>\n","      <td>217</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2</td>\n","      <td>Male</td>\n","      <td>76</td>\n","      <td>1</td>\n","      <td>3.0</td>\n","      <td>0</td>\n","      <td>1-2 Year</td>\n","      <td>No</td>\n","      <td>33536.0</td>\n","      <td>26.0</td>\n","      <td>183</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>3</td>\n","      <td>Male</td>\n","      <td>47</td>\n","      <td>1</td>\n","      <td>28.0</td>\n","      <td>0</td>\n","      <td>&gt; 2 Years</td>\n","      <td>Yes</td>\n","      <td>38294.0</td>\n","      <td>26.0</td>\n","      <td>27</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>4</td>\n","      <td>Male</td>\n","      <td>21</td>\n","      <td>1</td>\n","      <td>11.0</td>\n","      <td>1</td>\n","      <td>&lt; 1 Year</td>\n","      <td>No</td>\n","      <td>28619.0</td>\n","      <td>152.0</td>\n","      <td>203</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>5</td>\n","      <td>Female</td>\n","      <td>29</td>\n","      <td>1</td>\n","      <td>41.0</td>\n","      <td>1</td>\n","      <td>&lt; 1 Year</td>\n","      <td>No</td>\n","      <td>27496.0</td>\n","      <td>152.0</td>\n","      <td>39</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>381104</th>\n","      <td>381105</td>\n","      <td>Male</td>\n","      <td>74</td>\n","      <td>1</td>\n","      <td>26.0</td>\n","      <td>1</td>\n","      <td>1-2 Year</td>\n","      <td>No</td>\n","      <td>30170.0</td>\n","      <td>26.0</td>\n","      <td>88</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>381105</th>\n","      <td>381106</td>\n","      <td>Male</td>\n","      <td>30</td>\n","      <td>1</td>\n","      <td>37.0</td>\n","      <td>1</td>\n","      <td>&lt; 1 Year</td>\n","      <td>No</td>\n","      <td>40016.0</td>\n","      <td>152.0</td>\n","      <td>131</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>381106</th>\n","      <td>381107</td>\n","      <td>Male</td>\n","      <td>21</td>\n","      <td>1</td>\n","      <td>30.0</td>\n","      <td>1</td>\n","      <td>&lt; 1 Year</td>\n","      <td>No</td>\n","      <td>35118.0</td>\n","      <td>160.0</td>\n","      <td>161</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>381107</th>\n","      <td>381108</td>\n","      <td>Female</td>\n","      <td>68</td>\n","      <td>1</td>\n","      <td>14.0</td>\n","      <td>0</td>\n","      <td>&gt; 2 Years</td>\n","      <td>Yes</td>\n","      <td>44617.0</td>\n","      <td>124.0</td>\n","      <td>74</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>381108</th>\n","      <td>381109</td>\n","      <td>Male</td>\n","      <td>46</td>\n","      <td>1</td>\n","      <td>29.0</td>\n","      <td>0</td>\n","      <td>1-2 Year</td>\n","      <td>No</td>\n","      <td>41777.0</td>\n","      <td>26.0</td>\n","      <td>237</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>381109 rows Ã— 12 columns</p>\n","</div>"],"text/plain":["            id  Gender  Age  Driving_License  Region_Code  Previously_Insured  \\\n","0            1    Male   44                1         28.0                   0   \n","1            2    Male   76                1          3.0                   0   \n","2            3    Male   47                1         28.0                   0   \n","3            4    Male   21                1         11.0                   1   \n","4            5  Female   29                1         41.0                   1   \n","...        ...     ...  ...              ...          ...                 ...   \n","381104  381105    Male   74                1         26.0                   1   \n","381105  381106    Male   30                1         37.0                   1   \n","381106  381107    Male   21                1         30.0                   1   \n","381107  381108  Female   68                1         14.0                   0   \n","381108  381109    Male   46                1         29.0                   0   \n","\n","       Vehicle_Age Vehicle_Damage  Annual_Premium  Policy_Sales_Channel  \\\n","0        > 2 Years            Yes         40454.0                  26.0   \n","1         1-2 Year             No         33536.0                  26.0   \n","2        > 2 Years            Yes         38294.0                  26.0   \n","3         < 1 Year             No         28619.0                 152.0   \n","4         < 1 Year             No         27496.0                 152.0   \n","...            ...            ...             ...                   ...   \n","381104    1-2 Year             No         30170.0                  26.0   \n","381105    < 1 Year             No         40016.0                 152.0   \n","381106    < 1 Year             No         35118.0                 160.0   \n","381107   > 2 Years            Yes         44617.0                 124.0   \n","381108    1-2 Year             No         41777.0                  26.0   \n","\n","        Vintage  Response  \n","0           217         1  \n","1           183         0  \n","2            27         1  \n","3           203         0  \n","4            39         0  \n","...         ...       ...  \n","381104       88         0  \n","381105      131         0  \n","381106      161         0  \n","381107       74         0  \n","381108      237         0  \n","\n","[381109 rows x 12 columns]"]},"execution_count":10,"metadata":{},"output_type":"execute_result"}],"source":["train_df"]},{"cell_type":"code","execution_count":11,"metadata":{"execution":{"iopub.execute_input":"2023-05-29T10:13:10.611167Z","iopub.status.busy":"2023-05-29T10:13:10.610053Z","iopub.status.idle":"2023-05-29T10:13:10.61583Z","shell.execute_reply":"2023-05-29T10:13:10.616386Z","shell.execute_reply.started":"2023-03-23T09:21:13.710484Z"},"papermill":{"duration":0.059842,"end_time":"2023-05-29T10:13:10.616589","exception":false,"start_time":"2023-05-29T10:13:10.556747","status":"completed"},"tags":[]},"outputs":[],"source":["def get_uniques(df, columns):\n","    return {column: list(df[column].unique()) for column in columns}"]},{"cell_type":"code","execution_count":12,"metadata":{"execution":{"iopub.execute_input":"2023-05-29T10:13:10.719118Z","iopub.status.busy":"2023-05-29T10:13:10.718023Z","iopub.status.idle":"2023-05-29T10:13:10.832775Z","shell.execute_reply":"2023-05-29T10:13:10.833362Z","shell.execute_reply.started":"2023-03-23T09:21:13.717681Z"},"papermill":{"duration":0.170041,"end_time":"2023-05-29T10:13:10.833567","exception":false,"start_time":"2023-05-29T10:13:10.663526","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["{'Gender': ['Male', 'Female'],\n"," 'Vehicle_Age': ['> 2 Years', '1-2 Year', '< 1 Year'],\n"," 'Vehicle_Damage': ['Yes', 'No']}"]},"execution_count":12,"metadata":{},"output_type":"execute_result"}],"source":["categorical_features = ['Gender', 'Vehicle_Age', 'Vehicle_Damage']\n","\n","get_uniques(train_df, categorical_features)"]},{"cell_type":"markdown","metadata":{"papermill":{"duration":0.048838,"end_time":"2023-05-29T10:13:10.932505","exception":false,"start_time":"2023-05-29T10:13:10.883667","status":"completed"},"tags":[]},"source":["### Classify categorical features to be encoded"]},{"cell_type":"code","execution_count":13,"metadata":{"execution":{"iopub.execute_input":"2023-05-29T10:13:11.031665Z","iopub.status.busy":"2023-05-29T10:13:11.03056Z","iopub.status.idle":"2023-05-29T10:13:11.035408Z","shell.execute_reply":"2023-05-29T10:13:11.03602Z","shell.execute_reply.started":"2023-03-23T09:21:13.809225Z"},"papermill":{"duration":0.056255,"end_time":"2023-05-29T10:13:11.036211","exception":false,"start_time":"2023-05-29T10:13:10.979956","status":"completed"},"tags":[]},"outputs":[],"source":["binary_features = ['Gender', 'Vehicle_Damage']\n","\n","ordinal_features = ['Vehicle_Age']"]},{"cell_type":"markdown","metadata":{"papermill":{"duration":0.047184,"end_time":"2023-05-29T10:13:11.132547","exception":false,"start_time":"2023-05-29T10:13:11.085363","status":"completed"},"tags":[]},"source":["### Binary Encoding"]},{"cell_type":"code","execution_count":14,"metadata":{"execution":{"iopub.execute_input":"2023-05-29T10:13:11.232607Z","iopub.status.busy":"2023-05-29T10:13:11.231473Z","iopub.status.idle":"2023-05-29T10:13:11.238246Z","shell.execute_reply":"2023-05-29T10:13:11.238882Z","shell.execute_reply.started":"2023-03-23T09:21:13.81547Z"},"papermill":{"duration":0.058663,"end_time":"2023-05-29T10:13:11.23909","exception":false,"start_time":"2023-05-29T10:13:11.180427","status":"completed"},"tags":[]},"outputs":[],"source":["def binary_encode(df, column, positive_label):\n","    df = df.copy()\n","    df[column] = df[column].apply(lambda x: 1 if x == positive_label else 0)\n","    return df"]},{"cell_type":"code","execution_count":15,"metadata":{"execution":{"iopub.execute_input":"2023-05-29T10:13:11.344878Z","iopub.status.busy":"2023-05-29T10:13:11.344037Z","iopub.status.idle":"2023-05-29T10:13:12.201207Z","shell.execute_reply":"2023-05-29T10:13:12.200588Z","shell.execute_reply.started":"2023-03-23T09:21:13.826088Z"},"papermill":{"duration":0.911626,"end_time":"2023-05-29T10:13:12.201377","exception":false,"start_time":"2023-05-29T10:13:11.289751","status":"completed"},"tags":[]},"outputs":[],"source":["train_df = binary_encode(train_df, 'Gender', 'Male')\n","test_df = binary_encode(test_df, 'Gender', 'Male')\n","\n","train_df = binary_encode(train_df, 'Vehicle_Damage', 'Yes')\n","test_df = binary_encode(test_df, 'Vehicle_Damage', 'Yes')"]},{"cell_type":"markdown","metadata":{"papermill":{"duration":0.049575,"end_time":"2023-05-29T10:13:12.298775","exception":false,"start_time":"2023-05-29T10:13:12.2492","status":"completed"},"tags":[]},"source":["### Ordinal Encoding"]},{"cell_type":"code","execution_count":16,"metadata":{"execution":{"iopub.execute_input":"2023-05-29T10:13:12.403834Z","iopub.status.busy":"2023-05-29T10:13:12.402592Z","iopub.status.idle":"2023-05-29T10:13:12.405376Z","shell.execute_reply":"2023-05-29T10:13:12.405939Z","shell.execute_reply.started":"2023-03-23T09:21:14.355489Z"},"papermill":{"duration":0.058807,"end_time":"2023-05-29T10:13:12.406142","exception":false,"start_time":"2023-05-29T10:13:12.347335","status":"completed"},"tags":[]},"outputs":[],"source":["def ordinal_encode(df, column, ordering):\n","    df = df.copy()\n","    df[column] = df[column].apply(lambda x: ordering.index(x))\n","    return df"]},{"cell_type":"code","execution_count":17,"metadata":{"execution":{"iopub.execute_input":"2023-05-29T10:13:12.50691Z","iopub.status.busy":"2023-05-29T10:13:12.505821Z","iopub.status.idle":"2023-05-29T10:13:12.963848Z","shell.execute_reply":"2023-05-29T10:13:12.963073Z","shell.execute_reply.started":"2023-03-23T09:21:14.362428Z"},"papermill":{"duration":0.509778,"end_time":"2023-05-29T10:13:12.964001","exception":false,"start_time":"2023-05-29T10:13:12.454223","status":"completed"},"tags":[]},"outputs":[],"source":["age_ordering = ['< 1 Year', '1-2 Year', '> 2 Years']\n","\n","train_df = ordinal_encode(train_df, 'Vehicle_Age', age_ordering)\n","test_df = ordinal_encode(test_df, 'Vehicle_Age', age_ordering)"]},{"cell_type":"markdown","metadata":{"papermill":{"duration":0.047575,"end_time":"2023-05-29T10:13:13.058742","exception":false,"start_time":"2023-05-29T10:13:13.011167","status":"completed"},"tags":[]},"source":["# Splitting and Scaling"]},{"cell_type":"code","execution_count":18,"metadata":{"execution":{"iopub.execute_input":"2023-05-29T10:13:13.183414Z","iopub.status.busy":"2023-05-29T10:13:13.181246Z","iopub.status.idle":"2023-05-29T10:13:13.188201Z","shell.execute_reply":"2023-05-29T10:13:13.188974Z","shell.execute_reply.started":"2023-03-23T09:21:14.65293Z"},"papermill":{"duration":0.082571,"end_time":"2023-05-29T10:13:13.189176","exception":false,"start_time":"2023-05-29T10:13:13.106605","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>id</th>\n","      <th>Gender</th>\n","      <th>Age</th>\n","      <th>Driving_License</th>\n","      <th>Region_Code</th>\n","      <th>Previously_Insured</th>\n","      <th>Vehicle_Age</th>\n","      <th>Vehicle_Damage</th>\n","      <th>Annual_Premium</th>\n","      <th>Policy_Sales_Channel</th>\n","      <th>Vintage</th>\n","      <th>Response</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>44</td>\n","      <td>1</td>\n","      <td>28.0</td>\n","      <td>0</td>\n","      <td>2</td>\n","      <td>1</td>\n","      <td>40454.0</td>\n","      <td>26.0</td>\n","      <td>217</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2</td>\n","      <td>1</td>\n","      <td>76</td>\n","      <td>1</td>\n","      <td>3.0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>33536.0</td>\n","      <td>26.0</td>\n","      <td>183</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>3</td>\n","      <td>1</td>\n","      <td>47</td>\n","      <td>1</td>\n","      <td>28.0</td>\n","      <td>0</td>\n","      <td>2</td>\n","      <td>1</td>\n","      <td>38294.0</td>\n","      <td>26.0</td>\n","      <td>27</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>4</td>\n","      <td>1</td>\n","      <td>21</td>\n","      <td>1</td>\n","      <td>11.0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>28619.0</td>\n","      <td>152.0</td>\n","      <td>203</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>5</td>\n","      <td>0</td>\n","      <td>29</td>\n","      <td>1</td>\n","      <td>41.0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>27496.0</td>\n","      <td>152.0</td>\n","      <td>39</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>381104</th>\n","      <td>381105</td>\n","      <td>1</td>\n","      <td>74</td>\n","      <td>1</td>\n","      <td>26.0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>30170.0</td>\n","      <td>26.0</td>\n","      <td>88</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>381105</th>\n","      <td>381106</td>\n","      <td>1</td>\n","      <td>30</td>\n","      <td>1</td>\n","      <td>37.0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>40016.0</td>\n","      <td>152.0</td>\n","      <td>131</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>381106</th>\n","      <td>381107</td>\n","      <td>1</td>\n","      <td>21</td>\n","      <td>1</td>\n","      <td>30.0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>35118.0</td>\n","      <td>160.0</td>\n","      <td>161</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>381107</th>\n","      <td>381108</td>\n","      <td>0</td>\n","      <td>68</td>\n","      <td>1</td>\n","      <td>14.0</td>\n","      <td>0</td>\n","      <td>2</td>\n","      <td>1</td>\n","      <td>44617.0</td>\n","      <td>124.0</td>\n","      <td>74</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>381108</th>\n","      <td>381109</td>\n","      <td>1</td>\n","      <td>46</td>\n","      <td>1</td>\n","      <td>29.0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>41777.0</td>\n","      <td>26.0</td>\n","      <td>237</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>381109 rows Ã— 12 columns</p>\n","</div>"],"text/plain":["            id  Gender  Age  Driving_License  Region_Code  Previously_Insured  \\\n","0            1       1   44                1         28.0                   0   \n","1            2       1   76                1          3.0                   0   \n","2            3       1   47                1         28.0                   0   \n","3            4       1   21                1         11.0                   1   \n","4            5       0   29                1         41.0                   1   \n","...        ...     ...  ...              ...          ...                 ...   \n","381104  381105       1   74                1         26.0                   1   \n","381105  381106       1   30                1         37.0                   1   \n","381106  381107       1   21                1         30.0                   1   \n","381107  381108       0   68                1         14.0                   0   \n","381108  381109       1   46                1         29.0                   0   \n","\n","        Vehicle_Age  Vehicle_Damage  Annual_Premium  Policy_Sales_Channel  \\\n","0                 2               1         40454.0                  26.0   \n","1                 1               0         33536.0                  26.0   \n","2                 2               1         38294.0                  26.0   \n","3                 0               0         28619.0                 152.0   \n","4                 0               0         27496.0                 152.0   \n","...             ...             ...             ...                   ...   \n","381104            1               0         30170.0                  26.0   \n","381105            0               0         40016.0                 152.0   \n","381106            0               0         35118.0                 160.0   \n","381107            2               1         44617.0                 124.0   \n","381108            1               0         41777.0                  26.0   \n","\n","        Vintage  Response  \n","0           217         1  \n","1           183         0  \n","2            27         1  \n","3           203         0  \n","4            39         0  \n","...         ...       ...  \n","381104       88         0  \n","381105      131         0  \n","381106      161         0  \n","381107       74         0  \n","381108      237         0  \n","\n","[381109 rows x 12 columns]"]},"execution_count":18,"metadata":{},"output_type":"execute_result"}],"source":["train_df"]},{"cell_type":"code","execution_count":19,"metadata":{"execution":{"iopub.execute_input":"2023-05-29T10:13:13.301959Z","iopub.status.busy":"2023-05-29T10:13:13.301153Z","iopub.status.idle":"2023-05-29T10:13:13.319096Z","shell.execute_reply":"2023-05-29T10:13:13.319765Z","shell.execute_reply.started":"2023-03-23T09:21:14.682387Z"},"papermill":{"duration":0.081521,"end_time":"2023-05-29T10:13:13.319978","exception":false,"start_time":"2023-05-29T10:13:13.238457","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>id</th>\n","      <th>Gender</th>\n","      <th>Age</th>\n","      <th>Driving_License</th>\n","      <th>Region_Code</th>\n","      <th>Previously_Insured</th>\n","      <th>Vehicle_Age</th>\n","      <th>Vehicle_Damage</th>\n","      <th>Annual_Premium</th>\n","      <th>Policy_Sales_Channel</th>\n","      <th>Vintage</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>381110</td>\n","      <td>1</td>\n","      <td>25</td>\n","      <td>1</td>\n","      <td>11.0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>35786.0</td>\n","      <td>152.0</td>\n","      <td>53</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>381111</td>\n","      <td>1</td>\n","      <td>40</td>\n","      <td>1</td>\n","      <td>28.0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>33762.0</td>\n","      <td>7.0</td>\n","      <td>111</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>381112</td>\n","      <td>1</td>\n","      <td>47</td>\n","      <td>1</td>\n","      <td>28.0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>40050.0</td>\n","      <td>124.0</td>\n","      <td>199</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>381113</td>\n","      <td>1</td>\n","      <td>24</td>\n","      <td>1</td>\n","      <td>27.0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>37356.0</td>\n","      <td>152.0</td>\n","      <td>187</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>381114</td>\n","      <td>1</td>\n","      <td>27</td>\n","      <td>1</td>\n","      <td>28.0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>59097.0</td>\n","      <td>152.0</td>\n","      <td>297</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>127032</th>\n","      <td>508142</td>\n","      <td>0</td>\n","      <td>26</td>\n","      <td>1</td>\n","      <td>37.0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>30867.0</td>\n","      <td>152.0</td>\n","      <td>56</td>\n","    </tr>\n","    <tr>\n","      <th>127033</th>\n","      <td>508143</td>\n","      <td>0</td>\n","      <td>38</td>\n","      <td>1</td>\n","      <td>28.0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>28700.0</td>\n","      <td>122.0</td>\n","      <td>165</td>\n","    </tr>\n","    <tr>\n","      <th>127034</th>\n","      <td>508144</td>\n","      <td>1</td>\n","      <td>21</td>\n","      <td>1</td>\n","      <td>46.0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>29802.0</td>\n","      <td>152.0</td>\n","      <td>74</td>\n","    </tr>\n","    <tr>\n","      <th>127035</th>\n","      <td>508145</td>\n","      <td>1</td>\n","      <td>71</td>\n","      <td>1</td>\n","      <td>28.0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>62875.0</td>\n","      <td>26.0</td>\n","      <td>265</td>\n","    </tr>\n","    <tr>\n","      <th>127036</th>\n","      <td>508146</td>\n","      <td>1</td>\n","      <td>41</td>\n","      <td>1</td>\n","      <td>29.0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>27927.0</td>\n","      <td>124.0</td>\n","      <td>231</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>127037 rows Ã— 11 columns</p>\n","</div>"],"text/plain":["            id  Gender  Age  Driving_License  Region_Code  Previously_Insured  \\\n","0       381110       1   25                1         11.0                   1   \n","1       381111       1   40                1         28.0                   0   \n","2       381112       1   47                1         28.0                   0   \n","3       381113       1   24                1         27.0                   1   \n","4       381114       1   27                1         28.0                   1   \n","...        ...     ...  ...              ...          ...                 ...   \n","127032  508142       0   26                1         37.0                   1   \n","127033  508143       0   38                1         28.0                   0   \n","127034  508144       1   21                1         46.0                   1   \n","127035  508145       1   71                1         28.0                   1   \n","127036  508146       1   41                1         29.0                   1   \n","\n","        Vehicle_Age  Vehicle_Damage  Annual_Premium  Policy_Sales_Channel  \\\n","0                 0               0         35786.0                 152.0   \n","1                 1               1         33762.0                   7.0   \n","2                 1               1         40050.0                 124.0   \n","3                 0               1         37356.0                 152.0   \n","4                 0               0         59097.0                 152.0   \n","...             ...             ...             ...                   ...   \n","127032            0               0         30867.0                 152.0   \n","127033            1               1         28700.0                 122.0   \n","127034            0               0         29802.0                 152.0   \n","127035            1               0         62875.0                  26.0   \n","127036            1               0         27927.0                 124.0   \n","\n","        Vintage  \n","0            53  \n","1           111  \n","2           199  \n","3           187  \n","4           297  \n","...         ...  \n","127032       56  \n","127033      165  \n","127034       74  \n","127035      265  \n","127036      231  \n","\n","[127037 rows x 11 columns]"]},"execution_count":19,"metadata":{},"output_type":"execute_result"}],"source":["test_df"]},{"cell_type":"markdown","metadata":{"papermill":{"duration":0.049402,"end_time":"2023-05-29T10:13:13.42199","exception":false,"start_time":"2023-05-29T10:13:13.372588","status":"completed"},"tags":[]},"source":["We only need to save the IDs for the test set"]},{"cell_type":"code","execution_count":20,"metadata":{"execution":{"iopub.execute_input":"2023-05-29T10:13:13.543561Z","iopub.status.busy":"2023-05-29T10:13:13.541633Z","iopub.status.idle":"2023-05-29T10:13:13.585386Z","shell.execute_reply":"2023-05-29T10:13:13.584547Z","shell.execute_reply.started":"2023-03-23T09:21:14.709601Z"},"papermill":{"duration":0.114275,"end_time":"2023-05-29T10:13:13.585606","exception":false,"start_time":"2023-05-29T10:13:13.471331","status":"completed"},"tags":[]},"outputs":[],"source":["test_ids = test_df['id'].tolist()\n","\n","train_df = train_df.drop('id', axis=1)\n","test_df = test_df.drop('id', axis=1)"]},{"cell_type":"code","execution_count":21,"metadata":{"execution":{"iopub.execute_input":"2023-05-29T10:13:13.704833Z","iopub.status.busy":"2023-05-29T10:13:13.703692Z","iopub.status.idle":"2023-05-29T10:13:13.706779Z","shell.execute_reply":"2023-05-29T10:13:13.706141Z","shell.execute_reply.started":"2023-03-23T09:21:14.765029Z"},"papermill":{"duration":0.07055,"end_time":"2023-05-29T10:13:13.706942","exception":false,"start_time":"2023-05-29T10:13:13.636392","status":"completed"},"tags":[]},"outputs":[],"source":["y = train_df['Response']\n","X = train_df.drop('Response', axis=1)"]},{"cell_type":"markdown","metadata":{"papermill":{"duration":0.048622,"end_time":"2023-05-29T10:13:13.80661","exception":false,"start_time":"2023-05-29T10:13:13.757988","status":"completed"},"tags":[]},"source":["Let's check for outliers before choosing a scaler"]},{"cell_type":"code","execution_count":22,"metadata":{"execution":{"iopub.execute_input":"2023-05-29T10:13:13.91282Z","iopub.status.busy":"2023-05-29T10:13:13.911856Z","iopub.status.idle":"2023-05-29T10:13:15.261766Z","shell.execute_reply":"2023-05-29T10:13:15.26091Z","shell.execute_reply.started":"2023-03-23T09:21:14.781613Z"},"papermill":{"duration":1.406886,"end_time":"2023-05-29T10:13:15.261968","exception":false,"start_time":"2023-05-29T10:13:13.855082","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["<matplotlib.axes._subplots.AxesSubplot at 0x7a390ad87f50>"]},"execution_count":22,"metadata":{},"output_type":"execute_result"},{"data":{"image/png":"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\n","text/plain":["<Figure size 1440x720 with 1 Axes>"]},"metadata":{"needs_background":"light"},"output_type":"display_data"}],"source":["X.plot(kind='box', figsize=(20, 10), logy=True)"]},{"cell_type":"markdown","metadata":{"papermill":{"duration":0.049696,"end_time":"2023-05-29T10:13:15.363313","exception":false,"start_time":"2023-05-29T10:13:15.313617","status":"completed"},"tags":[]},"source":["Looks good, let's use MinMaxScaler"]},{"cell_type":"code","execution_count":23,"metadata":{"execution":{"iopub.execute_input":"2023-05-29T10:13:15.473712Z","iopub.status.busy":"2023-05-29T10:13:15.472902Z","iopub.status.idle":"2023-05-29T10:13:15.54408Z","shell.execute_reply":"2023-05-29T10:13:15.543356Z","shell.execute_reply.started":"2023-03-23T09:21:15.846945Z"},"papermill":{"duration":0.130264,"end_time":"2023-05-29T10:13:15.544233","exception":false,"start_time":"2023-05-29T10:13:15.413969","status":"completed"},"tags":[]},"outputs":[],"source":["scaler = MinMaxScaler()\n","\n","X = scaler.fit_transform(X)\n","test_df = scaler.fit_transform(test_df)"]},{"cell_type":"code","execution_count":24,"metadata":{"execution":{"iopub.execute_input":"2023-05-29T10:13:15.664294Z","iopub.status.busy":"2023-05-29T10:13:15.663497Z","iopub.status.idle":"2023-05-29T10:13:15.741757Z","shell.execute_reply":"2023-05-29T10:13:15.740966Z","shell.execute_reply.started":"2023-03-23T09:21:15.913363Z"},"papermill":{"duration":0.147189,"end_time":"2023-05-29T10:13:15.741928","exception":false,"start_time":"2023-05-29T10:13:15.594739","status":"completed"},"tags":[]},"outputs":[],"source":["X_train, X_test, y_train, y_test = train_test_split(X, y, train_size=0.7)"]},{"cell_type":"markdown","metadata":{"papermill":{"duration":0.051793,"end_time":"2023-05-29T10:13:15.846663","exception":false,"start_time":"2023-05-29T10:13:15.79487","status":"completed"},"tags":[]},"source":["# Building and Training a Model\n","\n","We will use a TensorFlow neural network"]},{"cell_type":"code","execution_count":25,"metadata":{"execution":{"iopub.execute_input":"2023-05-29T10:13:15.96011Z","iopub.status.busy":"2023-05-29T10:13:15.958866Z","iopub.status.idle":"2023-05-29T10:13:15.964382Z","shell.execute_reply":"2023-05-29T10:13:15.963717Z","shell.execute_reply.started":"2023-03-23T09:21:15.98076Z"},"papermill":{"duration":0.063603,"end_time":"2023-05-29T10:13:15.964527","exception":false,"start_time":"2023-05-29T10:13:15.900924","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["(381109, 10)"]},"execution_count":25,"metadata":{},"output_type":"execute_result"}],"source":["X.shape"]},{"cell_type":"code","execution_count":26,"metadata":{"execution":{"iopub.execute_input":"2023-05-29T10:13:16.07319Z","iopub.status.busy":"2023-05-29T10:13:16.072384Z","iopub.status.idle":"2023-05-29T10:13:16.077005Z","shell.execute_reply":"2023-05-29T10:13:16.076195Z","shell.execute_reply.started":"2023-03-23T09:21:15.988129Z"},"papermill":{"duration":0.061182,"end_time":"2023-05-29T10:13:16.077161","exception":false,"start_time":"2023-05-29T10:13:16.015979","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["(381109,)"]},"execution_count":26,"metadata":{},"output_type":"execute_result"}],"source":["y.shape"]},{"cell_type":"code","execution_count":27,"metadata":{"execution":{"iopub.execute_input":"2023-05-29T10:13:16.192191Z","iopub.status.busy":"2023-05-29T10:13:16.191392Z","iopub.status.idle":"2023-05-29T10:13:16.199132Z","shell.execute_reply":"2023-05-29T10:13:16.198496Z","shell.execute_reply.started":"2023-03-23T09:21:15.998698Z"},"papermill":{"duration":0.068398,"end_time":"2023-05-29T10:13:16.199328","exception":false,"start_time":"2023-05-29T10:13:16.13093","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["0.12256336113815208"]},"execution_count":27,"metadata":{},"output_type":"execute_result"}],"source":["y.sum() / len(y)"]},{"cell_type":"code","execution_count":28,"metadata":{"execution":{"iopub.execute_input":"2023-05-29T10:13:16.317563Z","iopub.status.busy":"2023-05-29T10:13:16.316665Z","iopub.status.idle":"2023-05-29T10:15:31.092537Z","shell.execute_reply":"2023-05-29T10:15:31.093201Z","shell.execute_reply.started":"2023-03-23T09:21:16.009861Z"},"papermill":{"duration":134.839054,"end_time":"2023-05-29T10:15:31.093573","exception":false,"start_time":"2023-05-29T10:13:16.254519","status":"completed"},"tags":[]},"outputs":[],"source":["inputs = tf.keras.Input(shape=(10,))\n","x = tf.keras.layers.Dense(64, activation='relu')(inputs)\n","x = tf.keras.layers.Dense(64, activation='relu')(x)\n","outputs = tf.keras.layers.Dense(1, activation='sigmoid')(x)\n","\n","model = tf.keras.Model(inputs=inputs, outputs=outputs)\n","\n","\n","model.compile(\n","    optimizer='adam',\n","    loss='binary_crossentropy',\n","    metrics=[tf.keras.metrics.AUC(name='auc')]\n",")\n","\n","\n","batch_size = 64\n","epochs = 25\n","\n","history = model.fit(\n","    X_train,\n","    y_train,\n","    validation_split=0.2,\n","    batch_size=batch_size,\n","    epochs=epochs,\n","    callbacks=[tf.keras.callbacks.ReduceLROnPlateau()],\n","    verbose=0\n",")"]},{"cell_type":"code","execution_count":29,"metadata":{"execution":{"iopub.execute_input":"2023-05-29T10:15:31.211013Z","iopub.status.busy":"2023-05-29T10:15:31.209982Z","iopub.status.idle":"2023-05-29T10:15:32.607617Z","shell.execute_reply":"2023-05-29T10:15:32.608251Z","shell.execute_reply.started":"2023-03-23T09:22:50.735191Z"},"papermill":{"duration":1.461169,"end_time":"2023-05-29T10:15:32.608474","exception":false,"start_time":"2023-05-29T10:15:31.147305","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["        <script type=\"text/javascript\">\n","        window.PlotlyConfig = {MathJaxConfig: 'local'};\n","        if (window.MathJax) {MathJax.Hub.Config({SVG: {font: \"STIX-Web\"}});}\n","        if (typeof require !== 'undefined') {\n","        require.undef(\"plotly\");\n","        requirejs.config({\n","            paths: {\n","                'plotly': ['https://cdn.plot.ly/plotly-latest.min']\n","            }\n","        });\n","        require(['plotly'], function(Plotly) {\n","            window._Plotly = Plotly;\n","        });\n","        }\n","        </script>\n","        "]},"metadata":{},"output_type":"display_data"},{"data":{"text/html":["<div>\n","        \n","        \n","            <div id=\"7254c6c9-564f-4645-8676-2d81a25d9542\" class=\"plotly-graph-div\" style=\"height:525px; width:100%;\"></div>\n","            <script type=\"text/javascript\">\n","                require([\"plotly\"], function(Plotly) {\n","                    window.PLOTLYENV=window.PLOTLYENV || {};\n","                    \n","                if (document.getElementById(\"7254c6c9-564f-4645-8676-2d81a25d9542\")) {\n","                    Plotly.newPlot(\n","                        '7254c6c9-564f-4645-8676-2d81a25d9542',\n","                        [{\"hovertemplate\": \"variable=loss<br>Epoch=%{x}<br>Loss=%{y}<extra></extra>\", \"legendgroup\": \"loss\", \"line\": {\"color\": \"#636efa\", \"dash\": \"solid\"}, \"mode\": \"lines\", \"name\": \"loss\", \"orientation\": \"v\", \"showlegend\": true, \"type\": \"scatter\", \"x\": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24], \"xaxis\": \"x\", \"y\": [0.2776479125022888, 0.2703262269496918, 0.2695156931877136, 0.26924556493759155, 0.2689923644065857, 0.2687380611896515, 0.26875436305999756, 0.2685859799385071, 0.26845791935920715, 0.2683402895927429, 0.2682572305202484, 0.2682884633541107, 0.26822540163993835, 0.26812395453453064, 0.26814401149749756, 0.268102765083313, 0.2680084705352783, 0.26805517077445984, 0.2680281400680542, 0.26786303520202637, 0.26791200041770935, 0.26713114976882935, 0.2669673264026642, 0.26692330837249756, 0.26689282059669495], \"yaxis\": \"y\"}, {\"hovertemplate\": \"variable=val_loss<br>Epoch=%{x}<br>Loss=%{y}<extra></extra>\", \"legendgroup\": \"val_loss\", \"line\": {\"color\": \"#EF553B\", \"dash\": \"solid\"}, \"mode\": \"lines\", \"name\": \"val_loss\", \"orientation\": \"v\", \"showlegend\": true, \"type\": \"scatter\", \"x\": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24], \"xaxis\": \"x\", \"y\": [0.2732565701007843, 0.2714955806732178, 0.2712535560131073, 0.27107149362564087, 0.2706719934940338, 0.2709988057613373, 0.272483766078949, 0.27102217078208923, 0.2707939147949219, 0.2711576819419861, 0.2704593241214752, 0.27047473192214966, 0.2706088423728943, 0.2709076702594757, 0.2713288962841034, 0.2706312835216522, 0.27121686935424805, 0.27098479866981506, 0.2710150480270386, 0.2711871266365051, 0.27065688371658325, 0.27031052112579346, 0.2703916132450104, 0.27034854888916016, 0.2703378200531006], \"yaxis\": \"y\"}],\n","                        {\"legend\": {\"title\": {\"text\": \"variable\"}, \"tracegroupgap\": 0}, \"template\": {\"data\": {\"bar\": [{\"error_x\": {\"color\": \"#2a3f5f\"}, \"error_y\": {\"color\": \"#2a3f5f\"}, \"marker\": {\"line\": {\"color\": \"#E5ECF6\", \"width\": 0.5}}, \"type\": \"bar\"}], \"barpolar\": [{\"marker\": {\"line\": {\"color\": \"#E5ECF6\", \"width\": 0.5}}, \"type\": \"barpolar\"}], \"carpet\": [{\"aaxis\": {\"endlinecolor\": \"#2a3f5f\", \"gridcolor\": \"white\", \"linecolor\": \"white\", \"minorgridcolor\": \"white\", \"startlinecolor\": \"#2a3f5f\"}, \"baxis\": {\"endlinecolor\": \"#2a3f5f\", \"gridcolor\": \"white\", \"linecolor\": \"white\", \"minorgridcolor\": \"white\", \"startlinecolor\": \"#2a3f5f\"}, \"type\": \"carpet\"}], \"choropleth\": [{\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}, \"type\": \"choropleth\"}], \"contour\": [{\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}, \"colorscale\": [[0.0, \"#0d0887\"], [0.1111111111111111, \"#46039f\"], [0.2222222222222222, \"#7201a8\"], [0.3333333333333333, \"#9c179e\"], [0.4444444444444444, \"#bd3786\"], [0.5555555555555556, \"#d8576b\"], [0.6666666666666666, \"#ed7953\"], [0.7777777777777778, \"#fb9f3a\"], [0.8888888888888888, \"#fdca26\"], [1.0, \"#f0f921\"]], \"type\": \"contour\"}], \"contourcarpet\": [{\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}, \"type\": \"contourcarpet\"}], \"heatmap\": [{\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}, \"colorscale\": [[0.0, \"#0d0887\"], [0.1111111111111111, \"#46039f\"], [0.2222222222222222, \"#7201a8\"], [0.3333333333333333, \"#9c179e\"], [0.4444444444444444, \"#bd3786\"], [0.5555555555555556, \"#d8576b\"], [0.6666666666666666, \"#ed7953\"], [0.7777777777777778, \"#fb9f3a\"], [0.8888888888888888, \"#fdca26\"], [1.0, \"#f0f921\"]], \"type\": \"heatmap\"}], \"heatmapgl\": [{\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}, \"colorscale\": [[0.0, \"#0d0887\"], [0.1111111111111111, \"#46039f\"], [0.2222222222222222, \"#7201a8\"], [0.3333333333333333, \"#9c179e\"], [0.4444444444444444, \"#bd3786\"], [0.5555555555555556, \"#d8576b\"], [0.6666666666666666, \"#ed7953\"], [0.7777777777777778, \"#fb9f3a\"], [0.8888888888888888, \"#fdca26\"], [1.0, \"#f0f921\"]], \"type\": \"heatmapgl\"}], \"histogram\": [{\"marker\": {\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}}, \"type\": \"histogram\"}], \"histogram2d\": [{\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}, \"colorscale\": [[0.0, \"#0d0887\"], [0.1111111111111111, \"#46039f\"], [0.2222222222222222, \"#7201a8\"], [0.3333333333333333, \"#9c179e\"], [0.4444444444444444, \"#bd3786\"], [0.5555555555555556, \"#d8576b\"], [0.6666666666666666, \"#ed7953\"], [0.7777777777777778, \"#fb9f3a\"], [0.8888888888888888, \"#fdca26\"], [1.0, \"#f0f921\"]], \"type\": \"histogram2d\"}], \"histogram2dcontour\": [{\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}, \"colorscale\": [[0.0, \"#0d0887\"], [0.1111111111111111, \"#46039f\"], [0.2222222222222222, \"#7201a8\"], [0.3333333333333333, \"#9c179e\"], [0.4444444444444444, \"#bd3786\"], [0.5555555555555556, \"#d8576b\"], [0.6666666666666666, \"#ed7953\"], [0.7777777777777778, \"#fb9f3a\"], [0.8888888888888888, \"#fdca26\"], [1.0, \"#f0f921\"]], \"type\": \"histogram2dcontour\"}], \"mesh3d\": [{\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}, \"type\": \"mesh3d\"}], \"parcoords\": [{\"line\": {\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}}, \"type\": \"parcoords\"}], \"pie\": [{\"automargin\": true, \"type\": \"pie\"}], \"scatter\": [{\"marker\": {\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}}, \"type\": \"scatter\"}], \"scatter3d\": [{\"line\": {\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}}, \"marker\": {\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}}, \"type\": \"scatter3d\"}], \"scattercarpet\": [{\"marker\": {\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}}, \"type\": \"scattercarpet\"}], \"scattergeo\": [{\"marker\": {\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}}, \"type\": \"scattergeo\"}], \"scattergl\": [{\"marker\": {\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}}, \"type\": \"scattergl\"}], \"scattermapbox\": [{\"marker\": {\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}}, \"type\": \"scattermapbox\"}], \"scatterpolar\": [{\"marker\": {\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}}, \"type\": \"scatterpolar\"}], \"scatterpolargl\": [{\"marker\": {\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}}, \"type\": \"scatterpolargl\"}], \"scatterternary\": [{\"marker\": {\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}}, \"type\": \"scatterternary\"}], \"surface\": [{\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}, \"colorscale\": [[0.0, \"#0d0887\"], [0.1111111111111111, \"#46039f\"], [0.2222222222222222, \"#7201a8\"], [0.3333333333333333, \"#9c179e\"], [0.4444444444444444, \"#bd3786\"], [0.5555555555555556, \"#d8576b\"], [0.6666666666666666, \"#ed7953\"], [0.7777777777777778, \"#fb9f3a\"], [0.8888888888888888, \"#fdca26\"], [1.0, \"#f0f921\"]], \"type\": \"surface\"}], \"table\": [{\"cells\": {\"fill\": {\"color\": \"#EBF0F8\"}, \"line\": {\"color\": \"white\"}}, \"header\": {\"fill\": {\"color\": \"#C8D4E3\"}, \"line\": {\"color\": \"white\"}}, \"type\": \"table\"}]}, \"layout\": {\"annotationdefaults\": {\"arrowcolor\": \"#2a3f5f\", \"arrowhead\": 0, \"arrowwidth\": 1}, \"coloraxis\": {\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}}, \"colorscale\": {\"diverging\": [[0, \"#8e0152\"], [0.1, \"#c51b7d\"], [0.2, \"#de77ae\"], [0.3, \"#f1b6da\"], [0.4, \"#fde0ef\"], [0.5, \"#f7f7f7\"], [0.6, \"#e6f5d0\"], [0.7, \"#b8e186\"], [0.8, \"#7fbc41\"], [0.9, \"#4d9221\"], [1, \"#276419\"]], \"sequential\": [[0.0, \"#0d0887\"], [0.1111111111111111, \"#46039f\"], [0.2222222222222222, \"#7201a8\"], [0.3333333333333333, \"#9c179e\"], [0.4444444444444444, \"#bd3786\"], [0.5555555555555556, \"#d8576b\"], [0.6666666666666666, \"#ed7953\"], [0.7777777777777778, \"#fb9f3a\"], [0.8888888888888888, \"#fdca26\"], [1.0, \"#f0f921\"]], \"sequentialminus\": [[0.0, \"#0d0887\"], [0.1111111111111111, \"#46039f\"], [0.2222222222222222, \"#7201a8\"], [0.3333333333333333, \"#9c179e\"], [0.4444444444444444, \"#bd3786\"], [0.5555555555555556, \"#d8576b\"], [0.6666666666666666, \"#ed7953\"], [0.7777777777777778, \"#fb9f3a\"], [0.8888888888888888, \"#fdca26\"], [1.0, \"#f0f921\"]]}, \"colorway\": [\"#636efa\", \"#EF553B\", \"#00cc96\", \"#ab63fa\", \"#FFA15A\", \"#19d3f3\", \"#FF6692\", \"#B6E880\", \"#FF97FF\", \"#FECB52\"], \"font\": {\"color\": \"#2a3f5f\"}, \"geo\": {\"bgcolor\": \"white\", \"lakecolor\": \"white\", \"landcolor\": \"#E5ECF6\", \"showlakes\": true, \"showland\": true, \"subunitcolor\": \"white\"}, \"hoverlabel\": {\"align\": \"left\"}, \"hovermode\": \"closest\", \"mapbox\": {\"style\": \"light\"}, \"paper_bgcolor\": \"white\", \"plot_bgcolor\": \"#E5ECF6\", \"polar\": {\"angularaxis\": {\"gridcolor\": \"white\", \"linecolor\": \"white\", \"ticks\": \"\"}, \"bgcolor\": \"#E5ECF6\", \"radialaxis\": {\"gridcolor\": \"white\", \"linecolor\": \"white\", \"ticks\": \"\"}}, \"scene\": {\"xaxis\": {\"backgroundcolor\": \"#E5ECF6\", \"gridcolor\": \"white\", \"gridwidth\": 2, \"linecolor\": \"white\", \"showbackground\": true, \"ticks\": \"\", \"zerolinecolor\": \"white\"}, \"yaxis\": {\"backgroundcolor\": \"#E5ECF6\", \"gridcolor\": \"white\", \"gridwidth\": 2, \"linecolor\": \"white\", \"showbackground\": true, \"ticks\": \"\", \"zerolinecolor\": \"white\"}, \"zaxis\": {\"backgroundcolor\": \"#E5ECF6\", \"gridcolor\": \"white\", \"gridwidth\": 2, \"linecolor\": \"white\", \"showbackground\": true, \"ticks\": \"\", \"zerolinecolor\": \"white\"}}, \"shapedefaults\": {\"line\": {\"color\": \"#2a3f5f\"}}, \"ternary\": {\"aaxis\": {\"gridcolor\": \"white\", \"linecolor\": \"white\", \"ticks\": \"\"}, \"baxis\": {\"gridcolor\": \"white\", \"linecolor\": \"white\", \"ticks\": \"\"}, \"bgcolor\": \"#E5ECF6\", \"caxis\": {\"gridcolor\": \"white\", \"linecolor\": \"white\", \"ticks\": \"\"}}, \"title\": {\"x\": 0.05}, \"xaxis\": {\"automargin\": true, \"gridcolor\": \"white\", \"linecolor\": \"white\", \"ticks\": \"\", \"title\": {\"standoff\": 15}, \"zerolinecolor\": \"white\", \"zerolinewidth\": 2}, \"yaxis\": {\"automargin\": true, \"gridcolor\": \"white\", \"linecolor\": \"white\", \"ticks\": \"\", \"title\": {\"standoff\": 15}, \"zerolinecolor\": \"white\", \"zerolinewidth\": 2}}}, \"title\": {\"text\": \"Training History\"}, \"xaxis\": {\"anchor\": \"y\", \"domain\": [0.0, 1.0], \"title\": {\"text\": \"Epoch\"}}, \"yaxis\": {\"anchor\": \"x\", \"domain\": [0.0, 1.0], \"title\": {\"text\": \"Loss\"}}},\n","                        {\"responsive\": true}\n","                    ).then(function(){\n","                            \n","var gd = document.getElementById('7254c6c9-564f-4645-8676-2d81a25d9542');\n","var x = new MutationObserver(function (mutations, observer) {{\n","        var display = window.getComputedStyle(gd).display;\n","        if (!display || display === 'none') {{\n","            console.log([gd, 'removed!']);\n","            Plotly.purge(gd);\n","            observer.disconnect();\n","        }}\n","}});\n","\n","// Listen for the removal of the full notebook cells\n","var notebookContainer = gd.closest('#notebook-container');\n","if (notebookContainer) {{\n","    x.observe(notebookContainer, {childList: true});\n","}}\n","\n","// Listen for the clearing of the current output cell\n","var outputEl = gd.closest('.output');\n","if (outputEl) {{\n","    x.observe(outputEl, {childList: true});\n","}}\n","\n","                        })\n","                };\n","                });\n","            </script>\n","        </div>"]},"metadata":{},"output_type":"display_data"}],"source":["fig = px.line(\n","    history.history, y=['loss', 'val_loss'], \n","    labels={'index': 'Epoch', 'value': 'Loss'}, \n","    title='Training History')\n","fig.show()"]},{"cell_type":"code","execution_count":30,"metadata":{"execution":{"iopub.execute_input":"2023-05-29T10:15:32.728016Z","iopub.status.busy":"2023-05-29T10:15:32.726457Z","iopub.status.idle":"2023-05-29T10:15:37.062529Z","shell.execute_reply":"2023-05-29T10:15:37.063147Z","shell.execute_reply.started":"2023-03-23T09:22:51.652725Z"},"papermill":{"duration":4.399739,"end_time":"2023-05-29T10:15:37.063352","exception":false,"start_time":"2023-05-29T10:15:32.663613","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["3573/3573 [==============================] - 4s 1ms/step - loss: 0.2672 - auc: 0.8519\n"]},{"data":{"text/plain":["[0.26719191670417786, 0.8518995642662048]"]},"execution_count":30,"metadata":{},"output_type":"execute_result"}],"source":["model.evaluate(X_test, y_test)"]},{"cell_type":"markdown","metadata":{"papermill":{"duration":0.091964,"end_time":"2023-05-29T10:15:37.246009","exception":false,"start_time":"2023-05-29T10:15:37.154045","status":"completed"},"tags":[]},"source":["# Make Predictions and Submit"]},{"cell_type":"code","execution_count":31,"metadata":{"execution":{"iopub.execute_input":"2023-05-29T10:15:37.442692Z","iopub.status.busy":"2023-05-29T10:15:37.441902Z","iopub.status.idle":"2023-05-29T10:15:37.455467Z","shell.execute_reply":"2023-05-29T10:15:37.454822Z","shell.execute_reply.started":"2023-03-23T09:22:54.650765Z"},"papermill":{"duration":0.114489,"end_time":"2023-05-29T10:15:37.455628","exception":false,"start_time":"2023-05-29T10:15:37.341139","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>id</th>\n","      <th>Response</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>381110</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>381111</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>381112</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>381113</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>381114</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>127032</th>\n","      <td>508142</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>127033</th>\n","      <td>508143</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>127034</th>\n","      <td>508144</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>127035</th>\n","      <td>508145</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>127036</th>\n","      <td>508146</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>127037 rows Ã— 2 columns</p>\n","</div>"],"text/plain":["            id  Response\n","0       381110         0\n","1       381111         0\n","2       381112         0\n","3       381113         0\n","4       381114         0\n","...        ...       ...\n","127032  508142         0\n","127033  508143         0\n","127034  508144         0\n","127035  508145         0\n","127036  508146         0\n","\n","[127037 rows x 2 columns]"]},"execution_count":31,"metadata":{},"output_type":"execute_result"}],"source":["sample_submission"]},{"cell_type":"code","execution_count":32,"metadata":{"execution":{"iopub.execute_input":"2023-05-29T10:15:37.642732Z","iopub.status.busy":"2023-05-29T10:15:37.641899Z","iopub.status.idle":"2023-05-29T10:15:39.960459Z","shell.execute_reply":"2023-05-29T10:15:39.95977Z","shell.execute_reply.started":"2023-03-23T09:22:54.66949Z"},"papermill":{"duration":2.41453,"end_time":"2023-05-29T10:15:39.960628","exception":false,"start_time":"2023-05-29T10:15:37.546098","status":"completed"},"tags":[]},"outputs":[],"source":["preds = model.predict(test_df)"]},{"cell_type":"code","execution_count":33,"metadata":{"execution":{"iopub.execute_input":"2023-05-29T10:15:40.175882Z","iopub.status.busy":"2023-05-29T10:15:40.171014Z","iopub.status.idle":"2023-05-29T10:15:40.297018Z","shell.execute_reply":"2023-05-29T10:15:40.296234Z","shell.execute_reply.started":"2023-03-23T09:22:56.500321Z"},"papermill":{"duration":0.242183,"end_time":"2023-05-29T10:15:40.297168","exception":false,"start_time":"2023-05-29T10:15:40.054985","status":"completed"},"tags":[]},"outputs":[],"source":["preds = list(map(lambda x: np.int(x[0]),  preds >= 0.5))"]},{"cell_type":"code","execution_count":34,"metadata":{"execution":{"iopub.execute_input":"2023-05-29T10:15:40.488108Z","iopub.status.busy":"2023-05-29T10:15:40.487335Z","iopub.status.idle":"2023-05-29T10:15:40.62758Z","shell.execute_reply":"2023-05-29T10:15:40.626717Z","shell.execute_reply.started":"2023-03-23T09:22:56.589867Z"},"papermill":{"duration":0.235288,"end_time":"2023-05-29T10:15:40.627741","exception":false,"start_time":"2023-05-29T10:15:40.392453","status":"completed"},"tags":[]},"outputs":[],"source":["submission = pd.concat([pd.Series(test_ids), pd.Series(preds)], axis=1)\n","submission.columns = ['id', 'Response']"]},{"cell_type":"code","execution_count":35,"metadata":{"execution":{"iopub.execute_input":"2023-05-29T10:15:40.821675Z","iopub.status.busy":"2023-05-29T10:15:40.820578Z","iopub.status.idle":"2023-05-29T10:15:40.825766Z","shell.execute_reply":"2023-05-29T10:15:40.824999Z","shell.execute_reply.started":"2023-03-23T09:22:56.656889Z"},"papermill":{"duration":0.107126,"end_time":"2023-05-29T10:15:40.825915","exception":false,"start_time":"2023-05-29T10:15:40.718789","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>id</th>\n","      <th>Response</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>381110</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>381111</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>381112</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>381113</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>381114</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>127032</th>\n","      <td>508142</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>127033</th>\n","      <td>508143</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>127034</th>\n","      <td>508144</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>127035</th>\n","      <td>508145</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>127036</th>\n","      <td>508146</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>127037 rows Ã— 2 columns</p>\n","</div>"],"text/plain":["            id  Response\n","0       381110         0\n","1       381111         0\n","2       381112         0\n","3       381113         0\n","4       381114         0\n","...        ...       ...\n","127032  508142         0\n","127033  508143         0\n","127034  508144         0\n","127035  508145         0\n","127036  508146         0\n","\n","[127037 rows x 2 columns]"]},"execution_count":35,"metadata":{},"output_type":"execute_result"}],"source":["submission"]},{"cell_type":"code","execution_count":36,"metadata":{"execution":{"iopub.execute_input":"2023-05-29T10:15:41.025062Z","iopub.status.busy":"2023-05-29T10:15:41.023963Z","iopub.status.idle":"2023-05-29T10:15:41.029625Z","shell.execute_reply":"2023-05-29T10:15:41.028823Z","shell.execute_reply.started":"2023-03-23T09:22:56.67008Z"},"papermill":{"duration":0.106644,"end_time":"2023-05-29T10:15:41.029786","exception":false,"start_time":"2023-05-29T10:15:40.923142","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["True"]},"execution_count":36,"metadata":{},"output_type":"execute_result"}],"source":["sample_submission.shape == submission.shape"]},{"cell_type":"code","execution_count":37,"metadata":{"execution":{"iopub.execute_input":"2023-05-29T10:15:41.225197Z","iopub.status.busy":"2023-05-29T10:15:41.224416Z","iopub.status.idle":"2023-05-29T10:15:41.858369Z","shell.execute_reply":"2023-05-29T10:15:41.859334Z","shell.execute_reply.started":"2023-03-23T09:22:56.679983Z"},"papermill":{"duration":0.735335,"end_time":"2023-05-29T10:15:41.859571","exception":false,"start_time":"2023-05-29T10:15:41.124236","status":"completed"},"tags":[]},"outputs":[],"source":["submission.to_csv('./submission.csv')"]}],"metadata":{"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.7.6"},"papermill":{"duration":169.707223,"end_time":"2023-05-29T10:15:42.067299","environment_variables":{},"exception":null,"input_path":"__notebook__.ipynb","output_path":"__notebook__.ipynb","parameters":{},"start_time":"2023-05-29T10:12:52.360076","version":"2.1.0"}},"nbformat":4,"nbformat_minor":4}